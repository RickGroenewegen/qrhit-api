// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model Isrc {
  id   Int    @id @default(autoincrement())
  isrc String @unique
  year Int

  @@index([isrc])
  @@map("isrc")
}

model Review {
  id        Int      @id @default(autoincrement())
  paymentId Int
  rating    Int
  review    String   @default("") @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  Payment   Payment  @relation(fields: [paymentId], references: [id], onDelete: Cascade)

  @@map("reviews")
}

model DiscountCode {
  id                Int                 @id @default(autoincrement())
  code              String              @unique
  amount            Float
  description       String?             @db.Text
  message           String?             @db.VarChar(255)
  from              String?             @db.VarChar(100)
  startDate         DateTime?
  endDate           DateTime?
  general           Boolean             @default(false)
  digital           Boolean             @default(false)
  playlistId        String?
  promotional       Boolean             @default(false)
  promotionalUserId Int?
  promotionalUser   User?               @relation("PromotionalDiscountCode", fields: [promotionalUserId], references: [id], onDelete: SetNull)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  DiscountCodedUses DiscountCodedUses[]

  @@index([code])
  @@index([promotionalUserId])
  @@map("discount_codes")
}

model DiscountCodedUses {
  id             Int          @id @default(autoincrement())
  amount         Float
  discountCode   DiscountCode @relation(fields: [discountCodeId], references: [id], onDelete: Cascade)
  discountCodeId Int
  payment        Payment?     @relation(fields: [paymentId], references: [id], onDelete: Cascade)
  paymentId      Int?
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  @@index([discountCodeId])
  @@map("discount_codes_uses")
}

model OrderType {
  id                 Int                  @id @default(autoincrement())
  type               String               @default("cards")
  name               String               @unique
  description        String
  amount             Float
  amountWithMargin   Float                @default(10)
  maxCards           Int                  @default(0)
  printApiProductId  String?
  createdAt          DateTime             @default(now())
  updatedAt          DateTime             @updatedAt
  digital            Boolean              @default(false)
  visible            Boolean              @default(true)
  Payment            Payment[]
  PaymentHasPlaylist PaymentHasPlaylist[]

  @@map("order_types")
}

model Payment {
  id                       Int                  @id @default(autoincrement())
  userId                   Int
  paymentId                String               @unique
  orderId                  String               @default("")
  printApiOrderId          String               @default("")
  printApiStatus           String               @default("Created")
  printApiShipped          Boolean              @default(false)
  printApiOrderRequest     String?              @default("") @db.Text
  printApiOrderResponse    String?              @default("") @db.Text
  printApiTrackingLink     String?              @default("")
  printApiPrice            Float                @default(0)
  printApiPriceInclVat     Float                @default(0)
  printApiInvoicePrice     Float                @default(0)
  printerInvoiceId         Int?
  clientIp                 String?
  totalPrice               Float
  totalPriceWithoutTax     Float                @default(0)
  status                   String
  createdAt                DateTime             @default(now())
  updatedAt                DateTime             @updatedAt
  fullname                 String
  email                    String
  isBusinessOrder          Boolean              @default(false)
  companyName              String?
  vatId                    String?
  address                  String?
  housenumber              String?
  city                     String?
  zipcode                  String?
  countrycode              String?
  shipping                 Float?
  taxRate                  Float?
  taxRateShipping          Float?
  shippingCode             String?
  shippingCountry          String?
  shippingPostalCode       String?
  shippingId               String?
  shippingStatus           String?
  shippingMessage          String?
  shippingStartDateTime    DateTime?
  shippingDeliveryDateTime DateTime?
  shippingIgnore           Boolean              @default(false)
  shippingLastTrackedAt    DateTime?
  shippingLastChangeType   String?
  marketingEmails          Boolean              @default(false)
  differentInvoiceAddress  Boolean              @default(false)
  invoiceAddress           String?
  invoiceHousenumber       String?
  invoiceCity              String?
  invoiceZipcode           String?
  invoiceCountrycode       String?
  paymentMethod            String?
  productPriceWithoutTax   Float
  shippingPriceWithoutTax  Float
  productVATPrice          Float
  shippingVATPrice         Float
  totalVATPrice            Float
  profit                   Float                @default(0)
  discount                 Float                @default(0)
  volumeDiscount           Float                @default(0)
  locale                   String               @default("en")
  qrSubDir                 String?
  finalized                Boolean              @default(false)
  allTracksChecked         Boolean              @default(false)
  user                     User?                @relation(fields: [userId], references: [id], onDelete: Cascade)
  PaymentHasPlaylist       PaymentHasPlaylist[]
  OrderType                OrderType?           @relation(fields: [orderTypeId], references: [id])
  orderTypeId              Int?
  test                     Boolean              @default(false)
  vibe                     Boolean              @default(false)
  reviewMailSent           Boolean              @default(false)
  reviewAllowed            Int                  @default(0)
  reviewAllowedAt          DateTime?
  finalizedAt              DateTime?
  canBeSentToPrinter       Boolean              @default(false)
  canBeSentToPrinterAt     DateTime?
  userAgreedToPrinting     Boolean              @default(false)
  userAgreedToPrintingAt   DateTime?
  sentToPrinter            Boolean              @default(false)
  sentToPrinterAt          DateTime?
  fast                     Boolean              @default(false)
  printerHold              Boolean              @default(true)
  processedFirstTime       Boolean              @default(false)
  processedFirstTimeAt     DateTime?
  printerInvoice           PrinterInvoice?      @relation(fields: [printerInvoiceId], references: [id], onDelete: SetNull)
  refundAmount             Float?
  refundedAt               DateTime?
  refundReason             String?

  DiscountCodedUses DiscountCodedUses[]
  Review            Review[]
  CompanyList       CompanyList[]

  @@index([userId])
  @@index([paymentId])
  @@index([printApiOrderId])
  @@index([fullname])
  @@index([orderId])
  @@index([status])
  @@index([finalized])
  @@index([test])
  @@index([vibe])
  @@index([createdAt])
  @@index([printApiStatus])
  @@index([shippingStatus])
  @@index([shippingLastTrackedAt])
  // Composite indexes for common query patterns
  @@index([vibe, test, createdAt])
  @@index([vibe, test, status, createdAt])
  @@index([vibe, test, finalized, createdAt])
  // Full-text search indexes for dashboard search
  @@fulltext([fullname, orderId, printApiOrderId, paymentId])
  @@map("payments")
}

model User {
  id                        Int              @id @default(autoincrement())
  userId                    String           @unique
  email                     String           @unique
  displayName               String
  locale                    String?
  country                   String?
  hash                      String           @unique
  password                  String?
  salt                      String?
  companyId                 Int?
  marketingEmails           Boolean          @default(false)
  sync                      Boolean          @default(false)
  payments                  Payment[]
  verificationHash          String?          @unique
  verified                  Boolean          @default(false)
  verifiedAt                DateTime?
  passwordResetToken        String?          @unique
  passwordResetExpiry       DateTime?
  gamesActivationCode       String?          @unique
  gamesActivationCodeExpiry DateTime?
  upgraded                  Boolean          @default(false)
  createdAt                 DateTime         @default(now())
  updatedAt                 DateTime         @updatedAt
  UserSuggestion            UserSuggestion[]
  UserGroupUser             UserInGroup[]
  Company                   Company?         @relation(fields: [companyId], references: [id], onDelete: Cascade)
  PromotionalDiscountCode   DiscountCode[]   @relation("PromotionalDiscountCode")

  @@index([hash])
  @@map("users")
}

model UserGroup {
  id            Int           @id @default(autoincrement())
  name          String        @unique
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @default(now())
  UserGroupUser UserInGroup[]

  @@map("user_groups")
}

model UserInGroup {
  id        Int      @id @default(autoincrement())
  userId    Int
  groupId   Int
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  UserGroup UserGroup @relation(fields: [groupId], references: [id], onDelete: Cascade)
  User      User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("user_in_groups")
}

model PushMessage {
  id              Int      @id @default(autoincrement())
  title           String
  message         String   @db.Text
  numberOfDevices Int
  test            Boolean  @default(false)
  dry             Boolean  @default(false)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@map("push_messages")
}

model PushToken {
  id        Int      @id @default(autoincrement())
  token     String   @unique
  type      String
  test      Boolean  @default(false)
  valid     Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([token])
  @@map("push_tokens")
}

model taxRate {
  id        Int       @id @default(autoincrement())
  rate      Float
  startDate DateTime?
  endDate   DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@map("taxrates")
}

model genre {
  id        Int        @id @default(autoincrement())
  slug      String?    @unique
  name_en   String
  name_nl   String
  name_de   String
  name_fr   String
  name_es   String
  name_it   String
  name_pt   String
  name_pl   String
  name_jp   String
  name_cn   String     @default("")
  name_sv   String     @default("")
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  Playlist  Playlist[]

  @@map("genres")
}

model Playlist {
  id                     Int                  @id @default(autoincrement())
  playlistId             String               @unique
  genreId                Int?
  type                   String               @default("cards")
  serviceType            String               @default("spotify") // Music service: spotify, youtube_music, apple_music, deezer, tidal
  name                   String
  slug                   String               @default("")
  description_en         String?              @db.Text
  description_nl         String?              @db.Text
  description_de         String?              @db.Text
  description_fr         String?              @db.Text
  description_es         String?              @db.Text
  description_it         String?              @db.Text
  description_pt         String?              @db.Text
  description_pl         String?              @db.Text
  description_jp         String?              @db.Text
  description_cn         String?              @db.Text
  description_sv         String?              @db.Text
  createdAt              DateTime             @default(now())
  updatedAt              DateTime             @updatedAt
  featured               Boolean              @default(false)
  featuredLocale         String?
  image                  String
  customImage            String?              @db.VarChar(255)
  price                  Float                @default(0)
  priceDigital           Float                @default(0)
  priceSheets            Float                @default(0)
  numberOfTracks         Int                  @default(0)
  resetCache             Boolean              @default(false)
  giftcardAmount         Float                @default(0)
  giftcardFrom           String?              @db.VarChar(100)
  giftcardMessage        String?              @db.VarChar(255)
  decadePercentage2020   Int                  @default(0)
  decadePercentage2010   Int                  @default(0)
  decadePercentage2000   Int                  @default(0)
  decadePercentage1990   Int                  @default(0)
  decadePercentage1980   Int                  @default(0)
  decadePercentage1970   Int                  @default(0)
  decadePercentage1960   Int                  @default(0)
  decadePercentage1950   Int                  @default(0)
  decadePercentage1900   Int                  @default(0)
  decadePercentage0      Int                  @default(0)
  decadesCalculated      Boolean              @default(false)
  downloads              Int                  @default(0)
  score                  Int                  @default(0)
  design                 Json?
  template               String?
  // Promotional playlist fields
  promotionalTitle       String?
  promotionalDescription String?              @db.Text
  promotionalActive      Boolean              @default(false)
  promotionalAccepted    Boolean              @default(false)
  promotionalDeclined    Boolean              @default(false)
  promotionalHide        Boolean              @default(false)
  promotionalLocale      String?              @db.VarChar(10)
  promotionalUserId      Int?
  tracks                 PlaylistHasTrack[]
  Payment                PaymentHasPlaylist[]
  UserSuggestion         UserSuggestion[]
  PlayListExtraInfo      TrackExtraInfo[]
  genre                  genre?               @relation(fields: [genreId], references: [id])
  CompanyList            CompanyList[]

  // Curation fields for featured playlists
  featuredHidden Boolean @default(false)

  @@index([playlistId])
  @@index([serviceType])
  @@index([promotionalActive])
  @@fulltext([name])
  @@map("playlists")
}

model UserSuggestion {
  id                   Int      @id @default(autoincrement())
  name                 String
  artist               String
  year                 Int
  extraNameAttribute   String?
  extraArtistAttribute String?
  comment              String?  @db.Text
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  track                Track    @relation(fields: [trackId], references: [id], onDelete: Cascade)
  trackId              Int
  playlist             Playlist @relation(fields: [playlistId], references: [id], onDelete: Cascade)
  playlistId           Int
  userId               Int
  user                 User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("usersuggestions")
}

model TrackExtraInfo {
  id                   Int      @id @default(autoincrement())
  playlist             Playlist @relation(fields: [playlistId], references: [id], onDelete: Cascade)
  playlistId           Int
  track                Track    @relation(fields: [trackId], references: [id], onDelete: Cascade)
  trackId              Int
  extraNameAttribute   String?
  extraArtistAttribute String?
  name                 String?
  artist               String?
  year                 Int?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  @@map("trackextrainfo")
}

model Track {
  id                         Int                          @id @default(autoincrement())
  trackId                    String                       @unique
  name                       String
  album                      String?
  preview                    String?
  artist                     String
  isrc                       String?
  year                       Int?
  spotifyYear                Int?
  discogsYear                Int?
  aiYear                     Int?
  musicBrainzYear            Int?
  openPerplexYear            Int?
  googleResults              String?                      @db.Text
  standardDeviation          Float                        @default(0)
  yearSource                 String?
  spotifyLink                String?
  certainty                  Int                          @default(0)
  reasoning                  String?                      @db.Text
  manuallyChecked            Boolean                      @default(false)
  manuallyCorrected          Boolean                      @default(false)
  youtubeLink                String?
  youtubeLinkNotFound        Boolean                      @default(false)
  deezerLink                 String?
  youtubeMusicLink           String?
  appleMusicLink             String?
  amazonMusicLink            String?
  tidalLink                  String?
  musicFetchLastAttempt      DateTime?
  musicFetchAttempts         Int                          @default(0)
  createdAt                  DateTime                     @default(now())
  updatedAt                  DateTime                     @updatedAt
  playlists                  PlaylistHasTrack[]
  UserSuggestion             UserSuggestion[]
  TrackExtraInfo             TrackExtraInfo[]
  CompanyListSubmissionTrack CompanyListSubmissionTrack[]

  @@index([trackId])
  @@index([isrc])
  @@index([manuallyChecked, year, id])
  @@index([youtubeLink])
  @@index([artist, name, manuallyChecked, year, id])
  @@fulltext([artist, name])
  @@map("tracks")
}

model ExternalCard {
  id Int @id @default(autoincrement())

  // Card type: 'jumbo' | 'country' | 'musicmatch'
  cardType String

  // Identification fields (one set per type)
  sku         String? // Jumbo: gameset SKU (e.g., 'aaaa0027')
  countryCode String? // Country: 'de', 'nl', etc.
  playlistId  String? // MusicMatch: payment_has_playlist_id
  cardNumber  String // Card number within set

  // Gameset metadata
  gamesetLanguage String?
  gamesetName     String?

  // Music service links (same as Track table)
  spotifyId        String? // Spotify track ID only
  spotifyLink      String? // Full Spotify URL
  appleMusicLink   String? @db.VarChar(500)
  tidalLink        String? @db.VarChar(500)
  youtubeMusicLink String? @db.VarChar(500)
  deezerLink       String? @db.VarChar(500)
  amazonMusicLink  String? @db.VarChar(500)

  // MusicFetch tracking
  musicFetchAttempts    Int       @default(0)
  musicFetchLastAttempt DateTime?
  processedByBatch      Boolean   @default(false) // Set to true when batch successfully adds links

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Composite unique constraints for each card type
  @@unique([cardType, sku, cardNumber], name: "jumbo_unique")
  @@unique([cardType, countryCode, cardNumber], name: "country_unique")
  @@unique([cardType, playlistId, cardNumber], name: "musicmatch_unique")
  // Indexes for lookups
  @@index([cardType])
  @@index([sku, cardNumber])
  @@index([countryCode, cardNumber])
  @@index([playlistId, cardNumber])
  @@index([spotifyId])
  @@map("external_cards")
}

model PrinterInvoice {
  id                Int     @id @default(autoincrement())
  invoiceNumber     String
  description       String? @db.Text
  totalPriceExclVat Float
  totalPriceInclVat Float
  lastUsedContentId String?

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  Payment   Payment[]

  @@map("printer_invoices")
}

// Join table for Playlist and Track
model PlaylistHasTrack {
  playlist   Playlist @relation(fields: [playlistId], references: [id], onDelete: Cascade)
  playlistId Int
  track      Track    @relation(fields: [trackId], references: [id], onDelete: Cascade)
  trackId    Int
  order      Int      @default(0)

  @@id([playlistId, trackId]) // Composite primary key
  @@map("playlist_has_tracks")
}

model PaymentHasPlaylist {
  id                         Int      @id @default(autoincrement())
  payment                    Payment  @relation(fields: [paymentId], references: [id], onDelete: Cascade)
  paymentId                  Int
  playlist                   Playlist @relation(fields: [playlistId], references: [id], onDelete: Cascade)
  playlistId                 Int
  amount                     Int
  numberOfTracks             Int
  orderTypeId                Int
  type                       String
  subType                    String?  @default("none")
  filename                   String?
  filenameDigital            String?
  filenameDigitalDoubleSided String?
  doubleSided                Boolean  @default(false)
  eco                        Boolean  @default(false)
  hideCircle                 Boolean  @default(false)
  qrBackgroundType           String   @default("square")
  qrColor                    String   @default("#000000")
  qrBackgroundColor          String   @default("#ffffff")
  price                      Float
  priceWithoutVAT            Float
  priceVAT                   Float
  printApiPrice              Float    @default(0)

  printApiUploaded        Boolean                  @default(false)
  printApiUploadResponse  String?                  @db.Text
  printerPageCount        Int                      @default(0)
  suggestionsPending      Boolean                  @default(false)
  eligableForPrinter      Boolean                  @default(false)
  eligableForPrinterAt    DateTime?
  userConfirmedPrinting   Boolean                  @default(false)
  blocked                 Boolean                  @default(false)
  emoji                   String?
  background              String?
  logo                    String?
  selectedFont            String?                  @default("Arial, sans-serif")
  selectedFontSize        String?                  @default("16px")
  // Front side color/gradient fields
  backgroundFrontType     String?                  @default("image") // 'solid' or 'image'
  backgroundFrontColor    String?                  @default("#ffffff")
  useFrontGradient        Boolean                  @default(false)
  gradientFrontColor      String?                  @default("#ffffff")
  gradientFrontDegrees    Int                      @default(180)
  gradientFrontPosition   Int                      @default(50)
  // Back side fields
  backgroundBackType      String?                  @default("image") // 'solid' or 'image'
  backgroundBack          String?
  backgroundBackColor     String?                  @default("#ffffff")
  fontColor               String?                  @default("#000000")
  useGradient             Boolean                  @default(false)
  gradientBackgroundColor String?                  @default("#ffffff")
  gradientDegrees         Int                      @default(180)
  gradientPosition        Int                      @default(50) // 0-100: controls color stop positions
  sameAsFront             Boolean                  @default(false) // Copy front side settings to back
  frontOpacity            Int                      @default(100) // Front background image opacity 0-100 (100% = fully visible by default)
  backOpacity             Int                      @default(50) // Back background image opacity 0-100 (default 50%)
  lastReloadAt            DateTime? // Timestamp of last playlist reload from Spotify
  theme                   String? // Theme slug for app theming (e.g., "acme", "coca-cola")
  themeName               String? // User-readable theme name (e.g., "Acme Company")
  printerType             String                   @default("printnbind") // Printer type: "printnbind" or "tromp"
  promotionalCredited     Boolean                  @default(false) // Whether promotional discount was credited to creator
  promotionalCreditedAt   DateTime? // When the promotional credit was applied
  orderType               OrderType                @relation(fields: [orderTypeId], references: [id], onDelete: Cascade)
  items                   PaymentHasPlaylistItem[]

  @@unique([paymentId, playlistId])
  @@index([paymentId])
  @@index([playlistId])
  @@index([type])
  @@index([paymentId, type])
  @@map("payment_has_playlist")
}

model PaymentHasPlaylistItem {
  id                   Int                @id @default(autoincrement())
  paymentHasPlaylistId Int
  paymentHasPlaylist   PaymentHasPlaylist @relation(fields: [paymentHasPlaylistId], references: [id], onDelete: Cascade)
  index                Int // 1, 2, 3, etc.
  filename             String? // printer_hash_1.pdf, printer_hash_2.pdf
  filenameDigital      String? // digital_hash_1.pdf, digital_hash_2.pdf
  createdAt            DateTime           @default(now())
  updatedAt            DateTime           @updatedAt

  @@unique([paymentHasPlaylistId, index])
  @@index([paymentHasPlaylistId])
  @@map("payment_has_playlist_item")
}

model ShippingCost {
  id        Int      @id @default(autoincrement())
  country   String
  amount    Int
  shipping  Float
  handling  Float
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([country, amount])
  @@map("shipping_costs")
}

model ShippingCostNew {
  id        Int      @id @default(autoincrement())
  country   String
  size      Int
  cost      Float
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([country, size])
  @@map("shipping_costs_new")
}

model CountryShippingConfig {
  id            Int      @id @default(autoincrement())
  countryCode   String   @unique
  minDaysOffset Int      @default(0)
  maxDaysOffset Int      @default(0)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([countryCode])
  @@map("country_shipping_config")
}

model TrustPilot {
  id          Int      @id @default(autoincrement())
  name        String
  country     String
  title_en    String
  title_nl    String
  title_de    String
  title_fr    String
  title_es    String
  title_it    String
  title_pt    String
  title_pl    String
  title_jp    String
  title_cn    String
  title_sv    String   @default("")
  message_en  String   @db.Text
  message_nl  String   @db.Text
  message_de  String   @db.Text
  message_fr  String   @db.Text
  message_es  String   @db.Text
  message_it  String   @db.Text
  message_pt  String   @db.Text
  message_pl  String   @db.Text
  message_jp  String   @db.Text
  message_cn  String   @db.Text
  message_sv  String   @default("") @db.Text
  rating      Float
  image       String
  locale      String?
  landingPage Boolean  @default(false)
  hide        Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("trustpilot")
}

model Company {
  id               Int           @id @default(autoincrement())
  name             String
  test             Boolean       @default(false)
  address          String?
  housenumber      String?
  city             String?
  zipcode          String?
  countrycode      String?
  contact          String?
  contactemail     String?
  contactphone     String?
  calculation      String?       @db.Text
  calculationTromp String?       @db.Text
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
  CompanyList      CompanyList[]
  User             User[]

  @@map("companies")
}

model CompanyList {
  id                      Int       @id @default(autoincrement())
  companyId               Int
  playlistId              Int?
  paymentId               Int?
  name                    String
  description_en          String    @default("")
  description_nl          String    @default("")
  description_de          String    @default("")
  description_fr          String    @default("")
  description_es          String    @default("")
  description_it          String    @default("")
  description_pt          String    @default("")
  description_pl          String    @default("")
  description_jp          String    @default("")
  description_cn          String    @default("")
  description_sv          String    @default("")
  slug                    String
  background              String?
  background2             String?
  playlistSource          String    @default("voting")
  playlistUrl             String?
  playlistUrlFull         String?
  qrColor                 String    @default("#000000")
  textColor               String    @default("#000000")
  status                  String    @default("new")
  numberOfTracks          Int
  minimumNumberOfTracks   Int?
  numberOfCards           Int       @default(0)
  startAt                 DateTime?
  endAt                   DateTime?
  votingBackground        String?
  votingLogo              String?
  buttonBackgroundColor   String    @default("#3b82f6")
  buttonTextColor         String    @default("#ffffff")
  downloadLink            String?
  reviewLink              String?
  languages               String    @default("nl")
  numberOfUncheckedTracks Int       @default(0)
  totalSpotifyTracks      Int       @default(0)
  spotifyRefreshRequired  Boolean   @default(true)
  hideCircle              Boolean   @default(false)
  showNames               Boolean   @default(false)
  qrvote                  Boolean   @default(false)
  addBirthdayNumber1      Boolean   @default(false)
  hideBirthdayNumber1     Boolean   @default(false)
  forceTemplate           String?
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt

  Company               Company                 @relation(fields: [companyId], references: [id], onDelete: Cascade)
  CompanyListSubmission CompanyListSubmission[]
  CompanyListQuestion   CompanyListQuestion[]
  Playlist              Playlist?               @relation(fields: [playlistId], references: [id], onDelete: SetNull)
  Payment               Payment?                @relation(fields: [paymentId], references: [id], onDelete: SetNull)

  @@map("company_lists")
}

model CompanyListQuestion {
  id            Int      @id @default(autoincrement())
  companyListId Int
  question      String
  type          String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  CompanyList                CompanyList                  @relation(fields: [companyListId], references: [id], onDelete: Cascade)
  CompanyListAnswer          CompanyListAnswer[]
  CompanyListQuestionOptions CompanyListQuestionOptions[]

  @@map("company_list_questions")
}

model CompanyListQuestionOptions {
  id         Int      @id @default(autoincrement())
  questionId Int
  name       String
  value      String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  CompanyListQuestion CompanyListQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@map("company_list_question_options")
}

model CompanyListSubmission {
  id               Int       @id @default(autoincrement())
  companyListId    Int
  hash             String    @unique
  verificationHash String?   @unique
  firstname        String?
  lastname         String?
  cardName         String?
  email            String?
  status           String    @default("open")
  verified         Boolean   @default(false)
  agreeToUseName   Boolean   @default(false)
  marketingEmails  Boolean   @default(false)
  verifiedAt       DateTime?
  locale           String    @default("en")
  birthDate        DateTime?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt

  CompanyList                CompanyList                  @relation(fields: [companyListId], references: [id], onDelete: Cascade)
  CompanyListSubmissionTrack CompanyListSubmissionTrack[] @relation("SubmissionToTracks")
  CompanyListAnswer          CompanyListAnswer[]

  @@index([companyListId])
  @@map("company_list_submissions")
}

model CompanyListAnswer {
  id           Int      @id @default(autoincrement())
  submissionId Int
  questionId   Int
  answer       String   @db.Text
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  CompanyListSubmission        CompanyListSubmission @relation(fields: [submissionId], references: [id], onDelete: Cascade)
  CompanyListQuestion          CompanyListQuestion   @relation(fields: [questionId], references: [id], onDelete: Cascade)
  companyListQuestionOptionsId Int?

  @@map("company_list_answers")
}

model CompanyListSubmissionTrack {
  id                      Int      @id @default(autoincrement())
  companyListSubmissionId Int
  trackId                 Int
  position                Int
  isBirthdayTrack         Boolean  @default(false)
  createdAt               DateTime @default(now())
  updatedAt               DateTime @updatedAt

  CompanyListSubmission CompanyListSubmission @relation("SubmissionToTracks", fields: [companyListSubmissionId], references: [id], onDelete: Cascade)
  Track                 Track                 @relation(fields: [trackId], references: [id], onDelete: Cascade)

  @@index([companyListSubmissionId])
  @@index([trackId])
  @@map("company_list_submission_has_tracks")
}

// Model for storing application-wide settings
model AppSetting {
  key       String   @id @unique // Unique key for the setting (e.g., "spotify_access_token")
  value     String   @db.Text // Value of the setting (use Text for potentially long tokens)
  updatedAt DateTime @updatedAt // Automatically track when the setting was last updated

  @@map("app_settings") // Optional: Define the table name explicitly
}

model Blog {
  id                 Int      @id @default(autoincrement())
  slug_en            String?  @unique
  slug_nl            String?  @unique
  slug_de            String?  @unique
  slug_fr            String?  @unique
  slug_es            String?  @unique
  slug_it            String?  @unique
  slug_pt            String?  @unique
  slug_pl            String?  @unique
  slug_jp            String?  @unique
  slug_cn            String?  @unique
  slug_sv            String?  @unique
  active             Boolean  @default(false)
  image              String?
  image_instructions String?  @db.Text
  title_en           String
  title_nl           String
  title_de           String
  title_fr           String
  title_es           String
  title_it           String
  title_pt           String
  title_pl           String
  title_jp           String
  title_cn           String
  title_sv           String   @default("")
  content_en         String   @db.Text
  content_nl         String   @db.Text
  content_de         String   @db.Text
  content_fr         String   @db.Text
  content_es         String   @db.Text
  content_it         String   @db.Text
  content_pt         String   @db.Text
  content_pl         String   @db.Text
  content_jp         String   @db.Text
  content_cn         String   @db.Text
  content_sv         String   @default("") @db.Text
  summary_en         String?  @db.Text
  summary_nl         String?  @db.Text
  summary_de         String?  @db.Text
  summary_fr         String?  @db.Text
  summary_es         String?  @db.Text
  summary_it         String?  @db.Text
  summary_pt         String?  @db.Text
  summary_pl         String?  @db.Text
  summary_jp         String?  @db.Text
  summary_cn         String?  @db.Text
  summary_sv         String?  @db.Text
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@map("blogs")
}

model Settings {
  id                Int      @id @default(autoincrement())
  productionDays    Int
  productionMessage String   @db.Text
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@map("settings")
}

model Chat {
  id             Int           @id @default(autoincrement())
  email          String?       @db.VarChar(255)
  username       String?       @db.VarChar(100)
  locale         String?       @db.VarChar(10)
  supportNeeded  Boolean       @default(false)
  hijacked       Boolean       @default(false)
  unseenMessages Boolean       @default(true)
  lastActivityAt DateTime      @default(now())
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
  messages       ChatMessage[]

  @@map("chats")
}

model ChatMessage {
  id                Int      @id @default(autoincrement())
  chatId            Int
  role              String   @db.VarChar(20)
  content           String   @db.Text
  translatedContent String?  @db.Text
  visibleToUser     Boolean  @default(true)
  createdAt         DateTime @default(now())
  chat              Chat     @relation(fields: [chatId], references: [id], onDelete: Cascade)

  @@index([chatId])
  @@map("chat_messages")
}

model ContactEmail {
  id                Int                 @id @default(autoincrement())
  name              String              @db.VarChar(255)
  email             String              @db.VarChar(255)
  locale            String?             @db.VarChar(10)
  subject           String?             @db.VarChar(255)
  message           String              @db.Text
  translatedMessage String?             @db.Text
  draftReply        String?             @db.Text
  ip                String?             @db.VarChar(45)
  isRead            Boolean             @default(false)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  replies           ContactEmailReply[]

  @@map("contact_emails")
}

model ContactEmailReply {
  id                Int          @id @default(autoincrement())
  contactEmailId    Int
  content           String       @db.Text
  translatedContent String?      @db.Text
  createdAt         DateTime     @default(now())
  contactEmail      ContactEmail @relation(fields: [contactEmailId], references: [id], onDelete: Cascade)

  @@index([contactEmailId])
  @@map("contact_email_replies")
}

model Top40Chart {
  id               Int      @id @default(autoincrement())
  year             Int
  weekNumber       Int
  position         Int
  artist           String
  title            String
  previousPosition Int      @default(0)
  weeksOnChart     Int      @default(1)
  status           String   @default("")
  externalId       String

  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@unique([year, weekNumber, position])
  @@index([year, weekNumber])
  @@index([position])
  @@index([externalId])
  @@map("top40_chart")
}

model BrokenLink {
  id          Int      @id @default(autoincrement())
  url         String   @db.Text
  type        String   @db.VarChar(20) // 'invalid' or 'non-retrievable'
  serviceType String?  @db.VarChar(50) // 'spotify', 'youtube_music', 'apple_music', 'deezer', 'tidal'
  errorType   String   @db.VarChar(100) // 'no_playlist_id', 'unrecognized_service', 'not_found', 'api_error', etc.
  userAgent   String?  @db.Text
  createdAt   DateTime @default(now())
  ignored     Boolean  @default(false)

  @@index([createdAt])
  @@index([ignored])
  @@index([type])
  @@map("broken_links")
}

model UnknownLink {
  id        Int      @id @default(autoincrement())
  url       String   @db.Text
  error     String?  @db.VarChar(255)
  userAgent String?  @db.Text
  clientIp  String?  @db.VarChar(45)
  createdAt DateTime @default(now())
  ignored   Boolean  @default(false)

  @@index([createdAt])
  @@index([ignored])
  @@map("unknown_links")
}
